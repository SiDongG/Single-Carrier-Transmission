function Bits_3=ZP_ML(Symbols3,N,Block_Num,H)
Symbols4=zeros(N,1,Block_Num);
Difference=zeros(1,16);
for a=1:Block_Num
    Difference(1)=sum(Symbols3(:,:,a)-H*(1/sqrt(2))*[1+1i;1+1i]);
    Difference(2)=sum(Symbols3(:,:,a)-H*(1/sqrt(2))*[1+1i;-1+1i]);
    Difference(3)=sum(Symbols3(:,:,a)-H*(1/sqrt(2))*[1+1i;-1-1i]);
    Difference(4)=sum(Symbols3(:,:,a)-H*(1/sqrt(2))*[1+1i;1-1i]);
    Difference(5)=sum(Symbols3(:,:,a)-H*(1/sqrt(2))*[-1+1i;1+1i]);
    Difference(6)=sum(Symbols3(:,:,a)-H*(1/sqrt(2))*[-1+1i;-1+1i]);
    Difference(7)=sum(Symbols3(:,:,a)-H*(1/sqrt(2))*[-1+1i;-1-1i]);
    Difference(8)=sum(Symbols3(:,:,a)-H*(1/sqrt(2))*[-1+1i;1-1i]);
    Difference(9)=sum(Symbols3(:,:,a)-H*(1/sqrt(2))*[-1-1i;1+1i]);
    Difference(10)=sum(Symbols3(:,:,a)-H*(1/sqrt(2))*[-1-1i;-1+1i]);
    Difference(11)=sum(Symbols3(:,:,a)-H*(1/sqrt(2))*[-1-1i;-1-1i]);
    Difference(12)=sum(Symbols3(:,:,a)-H*(1/sqrt(2))*[-1-1i;1-1i]);
    Difference(13)=sum(Symbols3(:,:,a)-H*(1/sqrt(2))*[1-1i;1+1i]);
    Difference(14)=sum(Symbols3(:,:,a)-H*(1/sqrt(2))*[1-1i;-1+1i]);
    Difference(15)=sum(Symbols3(:,:,a)-H*(1/sqrt(2))*[1-1i;-1-1i]);
    Difference(16)=sum(Symbols3(:,:,a)-H*(1/sqrt(2))*[1-1i;1-1i]);
    Position=find(Difference==min(Difference));
    Code=dec2bin(Position(1)-1,4);
    Symbols4(1,1,a)=str2double(Code(1));
    Symbols4(2,1,a)=str2double(Code(2));
    Symbols4(3,1,a)=str2double(Code(3));
    Symbols4(4,1,a)=str2double(Code(4));
end   
end